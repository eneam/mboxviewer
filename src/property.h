//
//////////////////////////////////////////////////////////////////
//
//  Windows Mbox Viewer is a free tool to view, search and print mbox mail archives..
//
// Source code and executable can be downloaded from
//  https://sourceforge.net/projects/mbox-viewer/  and
//  https://github.com/eneam/mboxviewer
//
//  Copyright(C) 2019  Enea Mansutti, Zbigniew Minciel
//
//  This program is free software; you can redistribute it and/or modify
//  it under the terms of the version 3 of GNU Affero General Public License
//  as published by the Free Software Foundation; 
//
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.See the GNU
//  Library General Public License for more details.
//
//  You should have received a copy of the GNU Library General Public
//  License along with this program; if not, write to the
//  Free Software Foundation, Inc., 51 Franklin St, Fifth Floor,
//  Boston, MA  02110 - 1301, USA.
//
//////////////////////////////////////////////////////////////////
//

#pragma once

#include <stdio.h>
#include <string.h>
#include <string>
#include <list>
#include <basetsd.h>

typedef enum {
    PidTagTemplateData = 0x0001,
    PidTagAlternateRecipientAllowed = 0x0002,
    PidTagNativeBody_String = 0x1003,
    PidTagScriptData = 0x0004,
    PidTagAutoForwardComment = 0x0004,
    PidTagAutoForwarded = 0x0005,
    PidTagDeferredDeliveryTime = 0x000F,
    PidTagDeliverTime = 0x0010,
    PidTagExpiryTime = 0x0015,
    PidTagImportance = 0x0017,
    PidTagMessageClass = 0x001A,
    PidTagOriginatorDeliveryReportRequested = 0x0023,
    PidTagParentKey = 0x0025,
    PidTagPriority = 0x0026,
    PidTagReadReceiptRequested = 0x0029,
    PidTagReceiptTime = 0x002A,
    PidTagRecipientReassignmentProhibited = 0x002B,
    PidTagOriginalSensitivity = 0x002E,
    PidTagReplyTime = 0x0030,
    PidTagReportTag = 0x0031,
    PidTagReportTime = 0x0032,
    PidTagSensitivity = 0x0036,
    PidTagSubject = 0x0037,
    PidTagClientSubmitTime = 0x0039,
    PidTagReportName = 0x003A,
    PidTagSentRepresentingSearchKey = 0x003B,
    PidTagSubjectPrefix = 0x003D,
    PidTagReceivedByEntryId = 0x003F,
    PidTagReceivedByName = 0x0040,
    PidTagSentRepresentingEntryId = 0x0041,
    PidTagSentRepresentingName = 0x0042,
    PidTagReceivedRepresentingEntryId = 0x0043,
    PidTagReceivedRepresentingName = 0x0044,
    PidTagReportEntryId = 0x0045,
    PidTagReadReceiptEntryId = 0x0046,
    PidTagMessageSubmissionId = 0x0047,
    PidTagOriginalSubject = 0x0049,
    PidTagOriginalMessageClass = 0x004B,
    PidTagOriginalAuthorEntryId = 0x004C,
    PidTagOriginalAuthorName = 0x004D,
    PidTagOriginalSubmitTime = 0x004E,
    PidTagReplyRecipientEntries = 0x004F,
    PidTagReplyRecipientNames = 0x0050,
    PidTagReceivedBySearchKey = 0x0051,
    PidTagReceivedRepresentingSearchKey = 0x0052,
    PidTagReadReceiptSearchKey = 0x0053,
    PidTagReportSearchKey = 0x0054,
    PidTagOriginalDeliveryTime = 0x0055,
    PidTagMessageToMe = 0x0057,
    PidTagMessageCcMe = 0x0058,
    PidTagMessageRecipientMe = 0x0059,
    PidTagOriginalSenderName = 0x005A,
    PidTagOriginalSenderEntryId = 0x005B,
    PidTagOriginalSenderSearchKey = 0x005C,
    PidTagOriginalSentRepresentingName = 0x005D,
    PidTagOriginalSentRepresentingEntryId = 0x005E,
    PidTagOriginalSentRepresentingSearchKey = 0x005F,
    PidTagStartDate = 0x0060,
    PidTagEndDate = 0x0061,
    PidTagOwnerAppointmentId = 0x0062,
    PidTagResponseRequested = 0x0063,
    PidTagSentRepresentingAddressType = 0x0064,
    PidTagSentRepresentingEmailAddress = 0x0065,
    PidTagOriginalSenderAddressType = 0x0066,
    PidTagOriginalSenderEmailAddress = 0x0067,
    PidTagOriginalSentRepresentingAddressType = 0x0068,
    PidTagOriginalSentRepresentingEmailAddress = 0x0069,
    PidTagConversationTopic = 0x0070,
    PidTagConversationIndex = 0x0071,
    PidTagOriginalDisplayBcc = 0x0072,
    PidTagOriginalDisplayCc = 0x0073,
    PidTagOriginalDisplayTo = 0x0074,
    PidTagReceivedByAddressType = 0x0075,
    PidTagReceivedByEmailAddress = 0x0076,
    PidTagReceivedRepresentingAddressType = 0x0077,
    PidTagReceivedRepresentingEmailAddress = 0x0078,
    PidTagTransportMessageHeaders = 0x007D,
    PidTagTnefCorrelationKey = 0x007F,
    PidTagReportDisposition = 0x0080,
    PidTagReportDispositionMode = 0x0081,
    PidTagAddressBookRoomCapacity = 0x0807,
    PidTagAddressBookRoomDescription = 0x0809,
    PidTagNonDeliveryReportReasonCode = 0x0C04,
    PidTagNonDeliveryReportDiagCode = 0x0C05,
    PidTagNonReceiptNotificationRequested = 0x0C06,
    PidTagOriginatorNonDeliveryReportRequested = 0x0C08,
    PidTagRecipientType = 0x0C15,
    PidTagReplyRequested = 0x0C17,
    PidTagSenderEntryId = 0x0C19,
    PidTagSenderName = 0x0C1A,
    PidTagSupplementaryInfo = 0x0C1B,
    PidTagSenderSearchKey = 0x0C1D,
    PidTagSenderAddressType = 0x0C1E,
    PidTagSenderEmailAddress = 0x0C1F,
    PidTagNonDeliveryReportStatusCode = 0x0C20,
    PidTagRemoteMessageTransferAgent = 0x0C21,
    PidTagDeleteAfterSubmit = 0x0E01,
    PidTagDisplayBcc = 0x0E02,
    PidTagDisplayCc = 0x0E03,
    PidTagDisplayTo = 0x0E04,
    PidTagMessageDeliveryTime = 0x0E06,
    PidTagMessageFlags = 0x0E07,
    PidTagMessageSize = 0x0E08,
    PidTagMessageSizeExtended = 0x0E08,
    PidTagParentEntryId = 0x0E09,
    PidTagResponsibility = 0x0E0F,
    PidTagMessageRecipients = 0x0E12,
    PidTagMessageAttachments = 0x0E13,
    PidTagMessageStatus = 0x0E17,
    PidTagHasAttachments = 0x0E1B,
    PidTagNormalizedSubject = 0x0E1D,
    PidTagRtfInSync = 0x0E1F,
    PidTagAttachSize = 0x0E20,
    PidTagAttachNumber = 0x0E21,
    PidTagPrimarySendAccount = 0x0E28,
    PidTagNextSendAcct = 0x0E29,
    PidTagToDoItemFlags = 0x0E2B,
    PidTagSwappedToDoStore = 0x0E2C,
    PidTagSwappedToDoData = 0x0E2D,
    PidTagRead = 0x0E69,
    PidTagSecurityDescriptorAsXml = 0x0E6A,
    PidTagTrustSender = 0x0E79,
    PidTagExchangeNTSecurityDescriptor = 0x0E84,
    PidTagExtendedRuleMessageActions = 0x0E99,
    PidTagExtendedRuleMessageCondition = 0x0E9A,
    PidTagExtendedRuleSizeLimit = 0x0E9B,
    PidTagAccess = 0x0FF4,
    PidTagRowType = 0x0FF5,
    PidTagInstanceKey = 0x0FF6,
    PidTagAccessLevel = 0x0FF7,
    PidTagMappingSignature = 0x0FF8,
    PidTagRecordKey = 0x0FF9,
    PidTagStoreEntryId = 0x0FFB,
    PidTagObjectType = 0x0FFE,
    PidTagEntryId = 0x0FFF,
    PidTagBody = 0x1000,
    PidTagReportText = 0x1001,
    PidTagRtfSyncBodyCount = 0x1007,
    PidTagRtfSyncBodyTag = 0x1008,
    PidTagRtfCompressed = 0x1009,
    PidTagRtfSyncPrefixCount = 0x1010,
    PidTagRtfSyncTrailingCount = 0x1011,
    PidTagHtml = 0x1013,
    PidTagBodyHtml = 0x1013,
    PidTagBodyContentLocation = 0x1014,
    PidTagBodyContentId = 0x1015,
    PidTagNativeBody = 0x1016,
    PidTagInternetMessageId = 0x1035,
    PidTagInternetReferences = 0x1039,
    PidTagInReplyToId = 0x1042,
    PidTagListHelp = 0x1043,
    PidTagListSubscribe = 0x1044,
    PidTagListUnsubscribe = 0x1045,
    PidTagOriginalMessageId = 0x1046,
    PidTagIconIndex = 0x1080,
    PidTagLastVerbExecuted = 0x1081,
    PidTagLastVerbExecutionTime = 0x1082,
    PidTagFlagStatus = 0x1090,
    PidTagFlagCompleteTime = 0x1091,
    PidTagFollowupIcon = 0x1095,
    PidTagBlockStatus = 0x1096,
    PidTagICalendarStartTime = 0x10C3,
    PidTagICalendarEndTime = 0x10C4,
    PidTagCdoRecurrenceid = 0x10C5,
    PidTagICalendarReminderNextTime = 0x10CA,
    PidTagAttributeHidden = 0x10F4,
    PidTagAttributeReadOnly = 0x10F6,
    PidTagRowid = 0x3000,
    PidTagDisplayName = 0x3001,
    PidTagAddressType = 0x3002,
    PidTagEmailAddress = 0x3003,
    PidTagComment = 0x3004,
    PidTagDepth = 0x3005,
    PidTagCreationTime = 0x3007,
    PidTagLastModificationTime = 0x3008,
    PidTagSearchKey = 0x300B,
    OrigEntryId = 0x300F,
    PidTagTargetEntryId = 0x3010,
    PidTagConversationId = 0x3013,
    PidTagConversationIndexTracking = 0x3016,
    PidTagArchiveTag = 0x3018,
    PidTagPolicyTag = 0x3019,
    PidTagRetentionPeriod = 0x301A,
    PidTagStartDateEtc = 0x301B,
    PidTagRetentionDate = 0x301C,
    PidTagRetentionFlags = 0x301D,
    PidTagArchivePeriod = 0x301E,
    PidTagArchiveDate = 0x301F,
    PidTagStoreSupportMask = 0x340D,
    PidTagStoreState = 0x340E,
    PidTagContainerFlags = 0x3600,
    PidTagFolderType = 0x3601,
    PidTagContentCount = 0x3602,
    PidTagContentUnreadCount = 0x3603,
    PidTagSelectable = 0x3609,
    PidTagSubfolders = 0x360A,
    PidTagAnr = 0x360C,
    PidTagContainerHierarchy = 0x360E,
    PidTagContainerContents = 0x360F,
    PidTagFolderAssociatedContents = 0x3610,
    PidTagContainerClass = 0x3613,
    PidTagIpmAppointmentEntryId = 0x36D0,
    PidTagIpmContactEntryId = 0x36D1,
    PidTagIpmJournalEntryId = 0x36D2,
    PidTagIpmNoteEntryId = 0x36D3,
    PidTagIpmTaskEntryId = 0x36D4,
    PidTagRemindersOnlineEntryId = 0x36D5,
    PidTagIpmDraftsEntryId = 0x36D7,
    PidTagAdditionalRenEntryIds = 0x36D8,
    PidTagAdditionalRenEntryIdsEx = 0x36D9,
    PidTagExtendedFolderFlags = 0x36DA,
    PidTagOrdinalMost = 0x36E2,
    PidTagFreeBusyEntryIds = 0x36E4,
    PidTagDefaultPostMessageClass = 0x36E5,
    PidTagClientActivelyEditingUntil = 0x3700,
    PidTagAttachDataObject = 0x3701,
    PidTagAttachDataBinary = 0x3701,
    PidTagAttachEncoding = 0x3702,
    PidTagAttachExtension = 0x3703,
    PidTagAttachFilename = 0x3704,
    PidTagAttachMethod = 0x3705,
    PidTagAttachLongFilename = 0x3707,
    PidTagAttachPathname = 0x3708,
    PidTagAttachRendering = 0x3709,
    PidTagAttachTag = 0x370A,
    PidTagRenderingPosition = 0x370B,
    PidTagAttachTransportName = 0x370C,
    PidTagAttachLongPathname = 0x370D,
    PidTagAttachMimeTag = 0x370E,
    PidTagAttachAdditionalInformation = 0x370F,
    PidTagAttachContentBase = 0x3711,
    PidTagAttachContentId = 0x3712,
    PidTagAttachContentLocation = 0x3713,
    PidTagAttachFlags = 0x3714,
    PidTagAttachPayloadProviderGuidString = 0x3719,
    PidTagAttachPayloadClass = 0x371A,
    PidTagTextAttachmentCharset = 0x371B,
    PidTagDisplayType = 0x3900,
    PidTagTemplateid = 0x3902,
    PidTagDisplayTypeEx = 0x3905,
    PidTagSmtpAddress = 0x39FE,
    PidTagAddressBookDisplayNamePrintable = 0x39FF,
    PidTagAccount = 0x3A00,
    PidTagCallbackTelephoneNumber = 0x3A02,
    PidTagGeneration = 0x3A05,
    PidTagGivenName = 0x3A06,
    PidTagGovernmentIdNumber = 0x3A07,
    PidTagBusinessTelephoneNumber = 0x3A08,
    PidTagHomeTelephoneNumber = 0x3A09,
    PidTagInitials = 0x3A0A,
    PidTagKeyword = 0x3A0B,
    PidTagLanguage = 0x3A0C,
    PidTagLocation = 0x3A0D,
    PidTagMessageHandlingSystemCommonName = 0x3A0F,
    PidTagOrganizationalIdNumber = 0x3A10,
    PidTagSurname = 0x3A11,
    PidTagOriginalEntryId = 0x3A12,
    PidTagPostalAddress = 0x3A15,
    PidTagCompanyName = 0x3A16,
    PidTagTitle = 0x3A17,
    PidTagDepartmentName = 0x3A18,
    PidTagOfficeLocation = 0x3A19,
    PidTagPrimaryTelephoneNumber = 0x3A1A,
    PidTagBusiness2TelephoneNumber = 0x3A1B,
    PidTagBusiness2TelephoneNumbers = 0x3A1B,
    PidTagMobileTelephoneNumber = 0x3A1C,
    PidTagRadioTelephoneNumber = 0x3A1D,
    PidTagCarTelephoneNumber = 0x3A1E,
    PidTagOtherTelephoneNumber = 0x3A1F,
    PidTagTransmittableDisplayName = 0x3A20,
    PidTagPagerTelephoneNumber = 0x3A21,
    PidTagUserCertificate = 0x3A22,
    PidTagPrimaryFaxNumber = 0x3A23,
    PidTagBusinessFaxNumber = 0x3A24,
    PidTagHomeFaxNumber = 0x3A25,
    PidTagCountry = 0x3A26,
    PidTagLocality = 0x3A27,
    PidTagStateOrProvince = 0x3A28,
    PidTagStreetAddress = 0x3A29,
    PidTagPostalCode = 0x3A2A,
    PidTagPostOfficeBox = 0x3A2B,
    PidTagTelexNumber = 0x3A2C,
    PidTagIsdnNumber = 0x3A2D,
    PidTagAssistantTelephoneNumber = 0x3A2E,
    PidTagHome2TelephoneNumber = 0x3A2F,
    PidTagHome2TelephoneNumbers = 0x3A2F,
    PidTagAssistant = 0x3A30,
    PidTagSendRichInfo = 0x3A40,
    PidTagWeddingAnniversary = 0x3A41,
    PidTagBirthday = 0x3A42,
    PidTagHobbies = 0x3A43,
    PidTagMiddleName = 0x3A44,
    PidTagDisplayNamePrefix = 0x3A45,
    PidTagProfession = 0x3A46,
    PidTagReferredByName = 0x3A47,
    PidTagSpouseName = 0x3A48,
    PidTagComputerNetworkName = 0x3A49,
    PidTagCustomerId = 0x3A4A,
    PidTagTelecommunicationsDeviceForDeafTelephoneNumber = 0x3A4B,
    PidTagFtpSite = 0x3A4C,
    PidTagGender = 0x3A4D,
    PidTagManagerName = 0x3A4E,
    PidTagNickname = 0x3A4F,
    PidTagPersonalHomePage = 0x3A50,
    PidTagBusinessHomePage = 0x3A51,
    PidTagCompanyMainTelephoneNumber = 0x3A57,
    PidTagChildrensNames = 0x3A58,
    PidTagHomeAddressCity = 0x3A59,
    PidTagHomeAddressCountry = 0x3A5A,
    PidTagHomeAddressPostalCode = 0x3A5B,
    PidTagHomeAddressStateOrProvince = 0x3A5C,
    PidTagHomeAddressStreet = 0x3A5D,
    PidTagHomeAddressPostOfficeBox = 0x3A5E,
    PidTagOtherAddressCity = 0x3A5F,
    PidTagOtherAddressCountry = 0x3A60,
    PidTagOtherAddressPostalCode = 0x3A61,
    PidTagOtherAddressStateOrProvince = 0x3A62,
    PidTagOtherAddressStreet = 0x3A63,
    PidTagOtherAddressPostOfficeBox = 0x3A64,
    PidTagUserX509Certificate = 0x3A70,
    PidTagSendInternetEncoding = 0x3A71,
    PidTagInitialDetailsPane = 0x3F08,
    PidTagInternetCodepage = 0x3FDE,
    PidTagAutoResponseSuppress = 0x3FDF,
    PidTagAccessControlListData = 0x3FE0,
    PidTagDelegatedByRule = 0x3FE3,
    PidTagResolveMethod = 0x3FE7,
    PidTagHasDeferredActionMessages = 0x3FEA,
    PidTagDeferredSendNumber = 0x3FEB,
    PidTagDeferredSendUnits = 0x3FEC,
    PidTagExpiryNumber = 0x3FED,
    PidTagExpiryUnits = 0x3FEE,
    PidTagDeferredSendTime = 0x3FEF,
    PidTagConflictEntryId = 0x3FF0,
    PidTagMessageLocaleId = 0x3FF1,
    PidTagCreatorName = 0x3FF8,
    PidTagCreatorEntryId = 0x3FF9,
    PidTagLastModifierName = 0x3FFA,
    PidTagLastModifierEntryId = 0x3FFB,
    PidTagMessageCodepage = 0x3FFD,
    MetaTagDnPrefix = 0x4008,
    MetaTagEcWarning = 0x400F,
    MetaTagNewFXFolder = 0x4011,
    MetaTagFXDelProp = 0x4016,
    MetaTagIdsetGiven = 0x4017,
    PidTagSentRepresentingFlags = 0x401A,
    MetaTagIdsetNoLongerInScope = 0x4021,
    PidTagReadReceiptAddressType = 0x4029,
    PidTagReadReceiptEmailAddress = 0x402A,
    PidTagReadReceiptName = 0x402B,
    MetaTagIdsetRead = 0x402D,
    MetaTagIdsetUnread = 0x402E,
    PidTagContentFilterSpamConfidenceLevel = 0x4076,
    PidTagSenderIdStatus = 0x4079,
    MetaTagIncrementalSyncMessagePartial = 0x407A,
    MetaTagIncrSyncGroupId = 0x407C,
    PidTagPurportedSenderDomain = 0x4083,
    PidTagInternetMailOverrideFormat = 0x5902,
    PidTagMessageEditorFormat = 0x5909,
    PidTagSenderSmtpAddress = 0x5D01,
    PidTagSentRepresentingSmtpAddress = 0x5D02,
    PidTagReadReceiptSmtpAddress = 0x5D05,
    PidTagReceivedBySmtpAddress = 0x5D07,
    PidTagReceivedRepresentingSmtpAddress = 0x5D08,
    PidTagRecipientOrder = 0x5FDF,
    PidTagRecipientProposed = 0x5FE1,
    PidTagRecipientProposedStartTime = 0x5FE3,
    PidTagRecipientProposedEndTime = 0x5FE4,
    PidTagRecipientDisplayName = 0x5FF6,
    PidTagRecipientEntryId = 0x5FF7,
    PidTagRecipientTrackStatusTime = 0x5FFB,
    PidTagRecipientFlags = 0x5FFD,
    PidTagRecipientTrackStatus = 0x5FFF,
    PidTagJunkIncludeContacts = 0x6100,
    PidTagJunkThreshold = 0x6101,
    PidTagJunkPermanentlyDelete = 0x6102,
    PidTagJunkAddRecipientsToSafeSendersList = 0x6103,
    PidTagJunkPhishingEnableLinks = 0x6107,
    PidTagMimeSkeleton = 0x64F0,
    PidTagReplyTemplateId = 0x65C2,
    PidTagSecureSubmitFlags = 0x65C6,
    PidTagSourceKey = 0x65E0,
    PidTagParentSourceKey = 0x65E1,
    PidTagChangeKey = 0x65E2,
    PidTagPredecessorChangeList = 0x65E3,
    PidTagRuleMessageState = 0x65E9,
    PidTagRuleMessageUserFlags = 0x65EA,
    PidTagRuleMessageProvider = 0x65EB,
    PidTagRuleMessageName = 0x65EC,
    PidTagRuleMessageLevel = 0x65ED,
    PidTagRuleMessageProviderData = 0x65EE,
    PidTagRuleMessageSequence = 0x65F3,
    PidTagUserEntryId = 0x6619,
    PidTagMailboxOwnerEntryId = 0x661B,
    PidTagMailboxOwnerName = 0x661C,
    PidTagOutOfOfficeState = 0x661D,
    PidTagSchedulePlusFreeBusyEntryId = 0x6622,
    PidTagRights = 0x6639,
    PidTagHasRules = 0x663A,
    PidTagAddressBookEntryId = 0x663B,
    PidTagHierarchyChangeNumber = 0x663E,
    PidTagClientActions = 0x6645,
    PidTagDamOriginalEntryId = 0x6646,
    PidTagDamBackPatched = 0x6647,
    PidTagRuleError = 0x6648,
    PidTagRuleActionType = 0x6649,
    PidTagHasNamedProperties = 0x664A,
    PidTagRuleActionNumber = 0x6650,
    PidTagRuleFolderEntryId = 0x6651,
    PidTagProhibitReceiveQuota = 0x666A,
    PidTagInConflict = 0x666C,
    PidTagMaximumSubmitMessageSize = 0x666D,
    PidTagProhibitSendQuota = 0x666E,
    PidTagMemberId = 0x6671,
    PidTagMemberName = 0x6672,
    PidTagMemberRights = 0x6673,
    PidTagRuleId = 0x6674,
    PidTagRuleIds = 0x6675,
    PidTagRuleSequence = 0x6676,
    PidTagRuleState = 0x6677,
    PidTagRuleUserFlags = 0x6678,
    PidTagRuleCondition = 0x6679,
    PidTagRuleActions = 0x6680,
    PidTagRuleProvider = 0x6681,
    PidTagRuleName = 0x6682,
    PidTagRuleLevel = 0x6683,
    PidTagRuleProviderData = 0x6684,
    PidTagDeletedOn = 0x668F,
    PidTagLocaleId = 0x66A1,
    PidTagCodePageId = 0x66C3,
    PidTagAddressBookManageDistributionList = 0x6704,
    PidTagSortLocaleId = 0x6705,
    PidTagLocalCommitTime = 0x6709,
    PidTagLocalCommitTimeMax = 0x670A,
    PidTagDeletedCountTotal = 0x670B,
    PidTagFlatUrlName = 0x670E,
    PidTagSentMailSvrEID = 0x6740,
    PidTagDeferredActionMessageOriginalEntryId = 0x6741,
    PidTagFolderId = 0x6748,
    PidTagParentFolderId = 0x6749,
    PidTagMid = 0x674A,
    PidTagInstID = 0x674D,
    PidTagInstanceNum = 0x674E,
    PidTagAddressBookMessageId = 0x674F,
    MetaTagIdsetExpired = 0x6793,
    MetaTagCnsetSeen = 0x6796,
    PidTagChangeNumber = 0x67A4,
    PidTagAssociated = 0x67AA,
    MetaTagCnsetRead = 0x67D2,
    MetaTagCnsetSeenFAI = 0x67DA,
    MetaTagIdsetDeleted = 0x67E5,
    PidTagOfflineAddressBookName = 0x6800,
    PidTagOfflineAddressBookSequence = 0x6801,
    PidTagOfflineAddressBookContainerGuid = 0x6802,
    PidTagRwRulesStream = 0x6802,
    PidTagSenderTelephoneNumber = 0x6802,
    PidTagOfflineAddressBookMessageClass = 0x6803,
    PidTagVoiceMessageSenderName = 0x6803,
    PidTagOfflineAddressBookDistinguishedName = 0x6804,
    PidTagFaxNumberOfPages = 0x6804,
    PidTagVoiceMessageAttachmentOrder = 0x6805,
    PidTagOfflineAddressBookTruncatedProperties = 0x6805,
    PidTagCallId = 0x6806,
    PidTagReportingMessageTransferAgent = 0x6820,
    PidTagSearchFolderLastUsed = 0x6834,
    PidTagSearchFolderExpiration = 0x683A,
    PidTagScheduleInfoResourceType = 0x6841,
    PidTagSearchFolderId = 0x6842,
    PidTagScheduleInfoDelegatorWantsCopy = 0x6842,
    PidTagScheduleInfoDontMailDelegates = 0x6843,
    PidTagScheduleInfoDelegateNames = 0x6844,
    PidTagSearchFolderRecreateInfo = 0x6844,
    PidTagScheduleInfoDelegateEntryIds = 0x6845,
    PidTagSearchFolderDefinition = 0x6845,
    PidTagSearchFolderStorageType = 0x6846,
    PidTagGatewayNeedsToRefresh = 0x6846,
    PidTagFreeBusyPublishStart = 0x6847,
    PidTagFreeBusyPublishEnd = 0x6848,
    PidTagFreeBusyMessageEmailAddress = 0x6849,
    PidTagWlinkType = 0x6849,
    PidTagWlinkFlags = 0x684A,
    PidTagScheduleInfoDelegateNamesW = 0x684A,
    PidTagScheduleInfoDelegatorWantsInfo = 0x684B,
    PidTagWlinkOrdinal = 0x684B,
    PidTagWlinkEntryId = 0x684C,
    PidTagWlinkRecordKey = 0x684D,
    PidTagWlinkStoreEntryId = 0x684E,
    PidTagScheduleInfoMonthsMerged = 0x684F,
    PidTagWlinkFolderType = 0x684F,
    PidTagScheduleInfoFreeBusyMerged = 0x6850,
    PidTagWlinkGroupClsid = 0x6850,
    PidTagScheduleInfoMonthsTentative = 0x6851,
    PidTagWlinkGroupName = 0x6851,
    PidTagScheduleInfoFreeBusyTentative = 0x6852,
    PidTagWlinkSection = 0x6852,
    PidTagWlinkCalendarColor = 0x6853,
    PidTagScheduleInfoMonthsBusy = 0x6853,
    PidTagScheduleInfoFreeBusyBusy = 0x6854,
    PidTagWlinkAddressBookEID = 0x6854,
    PidTagScheduleInfoMonthsAway = 0x6855,
    PidTagScheduleInfoFreeBusyAway = 0x6856,
    PidTagFreeBusyRangeTimestamp = 0x6868,
    PidTagFreeBusyCountMonths = 0x6869,
    PidTagScheduleInfoAppointmentTombstone = 0x686A,
    PidTagDelegateFlags = 0x686B,
    PidTagScheduleInfoFreeBusy = 0x686C,
    PidTagScheduleInfoAutoAcceptAppointments = 0x686D,
    PidTagScheduleInfoDisallowRecurringAppts = 0x686E,
    PidTagScheduleInfoDisallowOverlappingAppts = 0x686F,
    PidTagWlinkClientID = 0x6890,
    PidTagWlinkAddressBookStoreEID = 0x6891,
    PidTagWlinkROGroupType = 0x6892,
    PidTagViewDescriptorBinary = 0x7001,
    PidTagViewDescriptorStrings = 0x7002,
    PidTagViewDescriptorName = 0x7006,
    PidTagViewDescriptorVersion = 0x7007,
    PidTagRoamingDatatypes = 0x7C06,
    PidTagRoamingDictionary = 0x7C07,
    PidTagRoamingXmlStream = 0x7C08,
    PidTagOscSyncEnabled = 0x7C24,
    PidTagProcessed = 0x7D01,
    PidTagExceptionReplaceTime = 0x7FF9,
    PidTagAttachmentLinkId = 0x7FFA,
    PidTagExceptionStartTime = 0x7FFB,
    PidTagExceptionEndTime = 0x7FFC,
    PidTagAttachmentFlags = 0x7FFD,
    PidTagAttachmentHidden = 0x7FFE,
    PidTagAttachmentContactPhoto = 0x7FFF,
    PidTagAddressBookFolderPathname = 0x8004,
    PidTagAddressBookManager = 0x8005,
    PidTagAddressBookManagerDistinguishedName = 0x8005,
    PidTagAddressBookHomeMessageDatabase = 0x8006,
    PidTagAddressBookIsMemberOfDistributionList = 0x8008,
    PidTagAddressBookMember = 0x8009,
    PidTagAddressBookOwner = 0x800C,
    PidTagAddressBookReports = 0x800E,
    PidTagAddressBookProxyAddresses = 0x800F,
    PidTagAddressBookTargetAddress = 0x8011,
    PidTagAddressBookPublicDelegates = 0x8015,
    PidTagAddressBookOwnerBackLink = 0x8024,
    PidTagAddressBookExtensionAttribute1 = 0x802D,
    PidTagAddressBookExtensionAttribute2 = 0x802E,
    PidTagAddressBookExtensionAttribute3 = 0x802F,
    PidTagAddressBookExtensionAttribute4 = 0x8030,
    PidTagAddressBookExtensionAttribute5 = 0x8031,
    PidTagAddressBookExtensionAttribute6 = 0x8032,
    PidTagAddressBookExtensionAttribute7 = 0x8033,
    PidTagAddressBookExtensionAttribute8 = 0x8034,
    PidTagAddressBookExtensionAttribute9 = 0x8035,
    PidTagAddressBookExtensionAttribute10 = 0x8036,
    PidTagAddressBookObjectDistinguishedName = 0x803C,
    PidTagAddressBookDeliveryContentLength = 0x806A,
    PidTagAddressBookDistributionListMemberSubmitAccepted = 0x8073,
    PidTagAddressBookNetworkAddress = 0x8170,
    PidTagAddressBookExtensionAttribute11 = 0x8C57,
    PidTagAddressBookExtensionAttribute12 = 0x8C58,
    PidTagAddressBookExtensionAttribute13 = 0x8C59,
    PidTagAddressBookExtensionAttribute14 = 0x8C60,
    PidTagAddressBookExtensionAttribute15 = 0x8C61,
    PidTagAddressBookX509Certificate = 0x8C6A,
    PidTagAddressBookObjectGuid = 0x8C6D,
    PidTagAddressBookPhoneticGivenName = 0x8C8E,
    PidTagAddressBookPhoneticSurname = 0x8C8F,
    PidTagAddressBookPhoneticDepartmentName = 0x8C90,
    PidTagAddressBookPhoneticCompanyName = 0x8C91,
    PidTagAddressBookPhoneticDisplayName = 0x8C92,
    PidTagAddressBookDisplayTypeExtended = 0x8C93,
    PidTagAddressBookHierarchicalShowInDepartments = 0x8C94,
    PidTagAddressBookRoomContainers = 0x8C96,
    PidTagAddressBookHierarchicalDepartmentMembers = 0x8C97,
    PidTagAddressBookHierarchicalRootDepartment = 0x8C98,
    PidTagAddressBookHierarchicalParentDepartment = 0x8C99,
    PidTagAddressBookHierarchicalChildDepartments = 0x8C9A,
    PidTagThumbnailPhoto = 0x8C9E,
    PidTagAddressBookSeniorityIndex = 0x8CA0,
    PidTagAddressBookOrganizationalUnitRootDistinguishedName = 0x8CA8,
    PidTagAddressBookSenderHintTranslations = 0x8CAC,
    PidTagAddressBookModerationEnabled = 0x8CB5,
    PidTagSpokenName = 0x8CC2,
    PidTagAddressBookAuthorizedSenders = 0x8CD8,
    PidTagAddressBookUnauthorizedSenders = 0x8CD9,
    PidTagAddressBookDistributionListMemberSubmitRejected = 0x8CDA,
    PidTagAddressBookDistributionListRejectMessagesFromDLMembers = 0x8CDB,
    PidTagAddressBookHierarchicalIsHierarchicalGroup = 0x8CDD,
    PidTagAddressBookDistributionListMemberCount = 0x8CE2,
    PidTagAddressBookDistributionListExternalMemberCount = 0x8CE3,
    PidTagAddressBookIsMaster = 0xFFFB,
    PidTagAddressBookParentEntryId = 0xFFFC,
    PidTagAddressBookContainerId = 0xFFFD
} PropertId;

typedef enum {
    PtypInteger16 = 0x0002,
    PtypInteger32 = 0x0003,
    PtypFloating32 = 0x0004,
    PtypFloating64 = 0x0005,
    PtypCurrency = 0x0006,
    PtypFloatingTime = 0x0007,
    PtypErrorCode = 0x000A,
    PtypBoolean = 0x000B,
    PtypInteger64 = 0x0014,
    PtypTime = 0x0040,
    PtypGuid = 0x0048,
    PtypString8 = 0x001E,
    PtypString = 0x001F,
    PtypBinary = 0x0102,
    PtypObject = 0x000D,
    PtypMultipleInteger16 = 1002,
    PtypMultipleInteger32 = 1003,
    PtypMultipleFloating32 = 1004,
    PtypMultipleFloating64 = 1005,
    PtypMultipleCurrency = 1006,
    PtypMultipleFloatingTime = 1007,
    PtypMultipleInteger64 = 1014,
    PtypMultipleTime = 1040,
    PtypMultipleGuid = 1048,
    PtypMultipleBinary = 0x1102,
    PtypMultipleString8 = 0x101E,
    PtypMultipleString = 0x101F,
} PropertyType;

typedef struct 
{
    unsigned short id;
    char* name;
} CFBProperty;

char* id2name(UINT16 id);
char* idAll2name(UINT16 id);
char* idMailFilter2name(UINT16 id);
char* idBody2name(UINT16 id);
char* id2type(const char *id);
bool isFixedLengthType(UINT16 type);
bool isFixedLengthType64Bit(UINT16 type);

void* cfbf_malloc(size_t _Size);